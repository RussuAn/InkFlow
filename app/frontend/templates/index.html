{% extends "base.html" %}

{% block title %}
    {% if search_query %}–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É: {{ search_query }}{% else %}–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ InkFlow{% endif %}
{% endblock %}

{% block content %}

    <div style="padding-bottom: 4rem;">
        
        <div style="text-align: center; margin-bottom: 4rem; padding: 3rem 0;">
            {% if search_query %}
                
                <p style="color: var(--text-muted); margin-bottom: 0.5rem; text-transform: uppercase; font-size: 0.9rem; letter-spacing: 1px;">–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É</p>
                <h1 style="font-size: 2.5rem; margin-bottom: 1.5rem; color: var(--text-main);">"{{ search_query }}"</h1>
                <a href="{{ url_for('index') }}" class="btn-secondary" style="padding: 10px 25px; font-weight: 500;">
                    &larr; –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –∫–∞—Ç–∞–ª–æ–≥—É
                </a>

            {% else %}
                
                <h1 style="font-size: 3rem; margin-bottom: 1rem; line-height: 1.2; color: var(--text-main); font-family: var(--font-head);">
                    –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Å–≤—ñ—Ç —ñ—Å—Ç–æ—Ä—ñ–π
                </h1>
                <p style="color: var(--text-muted); font-size: 1.15rem; max-width: 600px; margin: 0 auto;">
                    –ó–∞–Ω—É—Ä—Ç–µ—Å—è –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –∑–∞—Ç–∏—à–Ω–æ–≥–æ —á–∏—Ç–∞–Ω–Ω—è –∑ –∫–æ–ª–µ–∫—Ü—ñ—î—é –Ω–∞–π–∫—Ä–∞—â–∏—Ö –∫–Ω–∏–≥
                </p>
                
                {% if current_user.is_authenticated and current_user.role == 'admin' %}
                    <div style="margin-top: 2rem;">
                        <a href="{{ url_for('books.add_book') }}" class="btn-primary" style="padding: 12px 30px;">
                            + –î–æ–¥–∞—Ç–∏ –∫–Ω–∏–≥—É
                        </a>
                    </div>
                {% endif %}
            {% endif %}
        </div>

        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 2rem;">
            
            {% for book in books %}
                <a href="{{ url_for('books.book_detail', book_id=book.id) }}" style="text-decoration: none; color: inherit; display: block;">
                    <div class="book-card card" style="height: 100%; display: flex; flex-direction: column; padding: 0; overflow: hidden; border: none; border-radius: 24px; transition: transform 0.3s ease, box-shadow 0.3s ease;">
                        
                        <div style="aspect-ratio: 3/4; position: relative; overflow: hidden;">
                            <img src="{{ url_for('static', filename='uploads/covers/' + book.cover_image) }}" 
                                 alt="{{ book.title }}" 
                                 style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s ease;">
                            
                            {% if book.genre %}
                            <div style="position: absolute; top: 16px; right: 16px; background-color: rgba(181, 138, 89, 0.9); color: white; padding: 6px 12px; border-radius: 8px; font-size: 0.75rem; font-weight: 600; text-transform: uppercase; letter-spacing: 0.05em; backdrop-filter: blur(4px);">
                                {{ book.genre }}
                            </div>
                            {% endif %}

                            <div style="position: absolute; bottom: 16px; left: 16px; background-color: rgba(42, 37, 34, 0.8); color: #B58A59; padding: 6px 12px; border-radius: 8px; font-size: 0.85rem; font-weight: 600; backdrop-filter: blur(4px); display: flex; align-items: center; gap: 4px;">
                                {% if book.price_coins == 0 %}
                                    –ë–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ
                                {% else %}
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg> 
                                    {{ book.price_coins }}
                                {% endif %}
                            </div>
                        </div>
                        
                        <div style="padding: 1.5rem; background-color: var(--bg-card);">
                            <h3 style="font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem; line-height: 1.3; color: var(--text-main); font-family: var(--font-head);">
                                {{ book.title }}
                            </h3>
                            <p style="color: var(--text-muted); font-size: 0.95rem; margin: 0;">
                                {{ book.author }}
                            </p>
                        </div>
                    </div>
                </a>
            {% else %}
                <div style="grid-column: 1/-1; text-align: center; padding: 6rem 0; color: var(--text-muted);">
                    <div style="font-size: 3rem; margin-bottom: 1rem;">üòï</div>
                    {% if search_query %}
                        <p style="font-size: 1.1rem;">–ú–∏ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π—à–ª–∏ –∑–∞ –∑–∞–ø–∏—Ç–æ–º "<strong>{{ search_query }}</strong>".</p>
                        <p style="font-size: 0.9rem;">–°–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –∫–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ –∞–±–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é.</p>
                    {% else %}
                        <p style="font-size: 1.1rem;">–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –ø–æ–∫–∏ —â–æ –ø–æ—Ä–æ–∂–Ω—è.</p>
                        <p style="font-size: 0.9rem;">–ó–∞–≤—ñ—Ç–∞–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ –∞–±–æ –¥–æ–¥–∞–π—Ç–µ –ø–µ—Ä—à—É –∫–Ω–∏–≥—É!</p>
                    {% endif %}
                </div>
            {% endfor %}

        </div>
    </div>

<style>
    .book-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-elevated);
    }
    .book-card:hover img {
        transform: scale(1.05);
    }
</style>
{% endblock %}