{% extends "base.html" %}

{% block title %}
    {% if search_query %}–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É: {{ search_query }}{% else %}–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ InkFlow{% endif %}
{% endblock %}

{% block content %}
<div style="padding-bottom: 3rem;">
    
    <div style="text-align: center; margin-bottom: 3rem; padding: 2rem 0;">
        {% if search_query %}
            <p style="color: var(--text-muted); margin-bottom: 0.5rem; text-transform: uppercase; font-size: 0.9rem; letter-spacing: 1px;">–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É</p>
            <h1 style="font-size: 2.5rem; margin-bottom: 1rem;">"{{ search_query }}"</h1>
            <a href="{{ url_for('index') }}" style="display: inline-block; padding: 8px 20px; border: 1px solid var(--border); border-radius: 20px; color: var(--text-main); text-decoration: none; font-size: 0.9rem; transition: background 0.2s;">
                &larr; –ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏
            </a>
        {% else %}
            <h1 style="font-size: 3rem; margin-bottom: 0.5rem; font-family: var(--font-head);">–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ InkFlow</h1>
            <p style="color: var(--text-muted); font-size: 1.1rem;">–ó–∞—Ç–∏—à–Ω–µ –º—ñ—Å—Ü–µ –¥–ª—è —Ç–≤–æ—ó—Ö —ñ—Å—Ç–æ—Ä—ñ–π.</p>
            
            {% if current_user.is_authenticated and current_user.role == 'admin' %}
                <div style="margin-top: 1.5rem;">
                    <a href="{{ url_for('books.add_book') }}" style="background: var(--text-main); color: var(--bg-body); padding: 10px 25px; border-radius: 30px; text-decoration: none; font-weight: 600; font-size: 0.9rem; box-shadow: var(--shadow);">
                        + –î–æ–¥–∞—Ç–∏ –∫–Ω–∏–≥—É
                    </a>
                </div>
            {% endif %}
        {% endif %}
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 2.5rem;">
        
        {% for book in books %}
            <a href="{{ url_for('books.book_detail', book_id=book.id) }}" style="text-decoration: none; color: inherit; display: block;">
                <div class="book-card" style="transition: transform 0.2s; height: 100%; display: flex; flex-direction: column;">
                    
                    <div style="aspect-ratio: 2/3; overflow: hidden; border-radius: 12px; box-shadow: var(--shadow); margin-bottom: 1rem; position: relative;">
                        <img src="{{ url_for('static', filename='uploads/covers/' + book.cover_image) }}" 
                             alt="{{ book.title }}" 
                             style="width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s;"
                             onmouseover="this.style.transform='scale(1.05)'"
                             onmouseout="this.style.transform='scale(1)'">
                        
                        {% if book.genre %}
                        <div style="position: absolute; top: 10px; left: 10px; background: rgba(255,255,255,0.9); color: #333; padding: 4px 8px; border-radius: 8px; font-size: 0.7rem; font-weight: 600; backdrop-filter: blur(4px); box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                            {{ book.genre }}
                        </div>
                        {% endif %}

                        <div style="position: absolute; top: 10px; right: 10px; background: rgba(0,0,0,0.7); color: white; padding: 4px 10px; border-radius: 12px; font-size: 0.8rem; font-weight: 600; backdrop-filter: blur(4px);">
                            {% if book.price_coins == 0 %}Free{% else %}{{ book.price_coins }} ü™ô{% endif %}
                        </div>
                    </div>
                    
                    <div style="flex: 1;">
                        <h3 style="font-size: 1.1rem; margin-bottom: 0.3rem; line-height: 1.4;">{{ book.title }}</h3>
                        <p style="color: var(--text-muted); font-size: 0.9rem; margin: 0;">{{ book.author }}</p>
                    </div>
                </div>
            </a>
        {% else %}
            <div style="grid-column: 1/-1; text-align: center; padding: 4rem 0; color: var(--text-muted);">
                <div style="font-size: 3rem; margin-bottom: 1rem;">üòï</div>
                {% if search_query %}
                    <p style="font-size: 1.1rem;">–ú–∏ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π—à–ª–∏ –∑–∞ –∑–∞–ø–∏—Ç–æ–º "<strong>{{ search_query }}</strong>".</p>
                    <p style="font-size: 0.9rem;">–°–ø—Ä–æ–±—É–π—Ç–µ –∑–º—ñ–Ω–∏—Ç–∏ –∫–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ –∞–±–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—é.</p>
                {% else %}
                    <p style="font-size: 1.1rem;">–ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ –ø–æ–∫–∏ —â–æ –ø–æ—Ä–æ–∂–Ω—è.</p>
                    <p style="font-size: 0.9rem;">–ó–∞–≤—ñ—Ç–∞–π—Ç–µ –ø—ñ–∑–Ω—ñ—à–µ –∞–±–æ –¥–æ–¥–∞–π—Ç–µ –ø–µ—Ä—à—É –∫–Ω–∏–≥—É!</p>
                {% endif %}
            </div>
        {% endfor %}

    </div>
</div>

<style>
    .book-card:hover {
        transform: translateY(-5px);
    }
</style>
{% endblock %}